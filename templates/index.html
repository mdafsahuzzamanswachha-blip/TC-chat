<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TC Chat</title>
<script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
<style>
body {font-family: Arial, sans-serif; background:#1e1e2f; color:#fff; display:flex; flex-direction:column; align-items:center; height:100vh; margin:0;}
h2 {margin-top:20px;color:#00d8ff;}
#chat {flex:1;width:90%;max-width:600px;background:#2a2a40;padding:10px;margin:20px 0;border-radius:10px;overflow-y:auto;}
.message {background:#3a3a60;margin:5px 0;padding:8px 12px;border-radius:8px;word-wrap:break-word;}
#inputContainer {display:flex;width:90%;max-width:600px;margin-bottom:10px;}
#msg {flex:1;padding:10px;border-radius:8px;border:none;outline:none;font-size:16px;resize:none;background:#2a2a40;color:#fff;}
button {padding:10px 20px;margin-left:10px;border:none;border-radius:8px;background:#00d8ff;color:#000;font-weight:bold;cursor:pointer;}
button:hover {background:#00b8cc;}
.timestamp {font-size:10px;color:#aaa;margin-left:5px;}
</style>
</head>
<body>
<h2>TC Chat</h2>
<div id="chat"></div>

<div>
<input id="nickname" type="text" placeholder="Enter nickname" />
</div>

<div id="inputContainer">
<textarea id="msg" placeholder="Type your message..." rows="1"></textarea>
<input type="file" id="imgInput" accept="image/*"/>
<button onclick="sendMessage()">Send</button>
</div>

<script>
var socket = io();
var msgInput = document.getElementById("msg");
var chat = document.getElementById("chat");
var nicknameInput = document.getElementById("nickname");
var imgInput = document.getElementById("imgInput");

// Receiving message
socket.on("message", function(msg){
    let div = document.createElement("div");
    div.classList.add("message");
    div.innerHTML = msg;
    chat.appendChild(div);
    chat.scrollTop = chat.scrollHeight;
});

// Sending message
function sendMessage(){
    let msg = msgInput.value.trim();
    if(msg === "") return;

    let nickname = nicknameInput.value.trim() || "Anonymous";

    // handle image
    let file = imgInput.files[0];
    if(file){
        let reader = new FileReader();
        reader.onload = function(e){
            let imageData = e.target.result;
            socket.send({msg: msg, nickname: nickname, image: imageData});
            msgInput.value = "";
            imgInput.value = "";
        };
        reader.readAsDataURL(file);
    } else {
        socket.send({msg: msg, nickname: nickname, image: ""});
        msgInput.value = "";
    }
}

// Enter & Shift+Enter
msgInput.addEventListener("keydown", function(e){
    if(e.key === "Enter"){
        if(!e.shiftKey){
            e.preventDefault();
            sendMessage();
        }
    }
});
</script>
</body>
</html>
